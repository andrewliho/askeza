# Askeza - Мастерская v2

## Введение

"Мастерская" — это ключевой компонент приложения Askeza, который предоставляет пользователям библиотеку кураторских шаблонов практик самосовершенствования. Версия 2.0 значительно расширяет функциональность, добавляя:

- Grid-галерею шаблонов с фильтрацией и поиском
- Отслеживание прогресса и систему статусов
- Геймификацию с награждением XP и уровнями
- Курсы-"Пути" для последовательного развития
- Социальные функции для шеринга достижений

## Архитектура

### Ключевые сущности

- **PracticeTemplate**: Кураторский шаблон практики
- **TemplateProgress**: Прогресс пользователя по каждому шаблону
- **CoursePath**: Набор связанных шаблонов, проходятся последовательно
- **UserProfile**: Профиль пользователя с XP и уровнями

### Технический стек

- **SwiftData**: Хранение моделей и их отношений
- **Сервисный слой**: Dependency Injection с использованием ServiceResolver
- **Модульная архитектура**: Каждый компонент имеет четкую ответственность

## Инструкция по использованию

### Для пользователей

1. **Просмотр шаблонов**: В Grid-галерее можно просматривать все доступные шаблоны практик
2. **Фильтрация**: Используйте фильтры по категории, сложности и длительности
3. **Детали шаблона**: Нажмите на карточку для просмотра подробной информации
4. **Старт практики**: Кнопка "Начать практику" создает новую аскезу из шаблона
5. **Пути развития**: Последовательные наборы практик для комплексного развития
6. **Прогресс**: Отслеживайте прогресс по каждой практике, получайте награды и XP

### Для разработчиков

#### Файловая структура

```
/Askeza
    /Models
        PracticeTemplate.swift    # SwiftData модели шаблонов и прогресса
    /ViewModels
        PracticeTemplateStore.swift  # Сервисы и хранилище
    /Views/Workshop
        WorkshopV2View.swift      # Главное представление мастерской
        WorkshopGridView.swift    # Grid-галерея шаблонов
        TemplateDetailView.swift  # Детали шаблона
        TemplateCardView.swift    # Карточка шаблона для галереи
    /Resources
        Templates.json            # Набор шаблонов для предзагрузки
```

#### Ключевые компоненты

1. **ServiceResolver**: Центральный компонент DI для доступа к сервисам
2. **TemplateService**: CRUD-операции с шаблонами
3. **ProgressService**: Управление прогрессом и наградами
4. **UserService**: Управление профилем пользователя
5. **RecommendationEngine**: Система рекомендаций шаблонов

## Статусы и достижения

| Статус | Условие | UI-индикатор | Награда |
|--------|---------|--------------|---------|
| Not Started | Шаблон не активирован | Серый бейдж | — |
| In Progress | Есть активная аскеза | Прогресс-бар + стрик | +XP ежедневно |
| Completed | Закрыты все дни | Золотая рамка ✔︎ | Медаль, +уровень |
| Mastered | 3× Completed или ≥90 дней | Радужная рамка ★ | Разблокирует Pro-шаблоны |

## Курсы-"Пути"

Курсы представляют собой последовательные наборы шаблонов для комплексного развития в определенной области. Каждый следующий шаг становится доступным после завершения предыдущего.

## Импорт шаблонов

Шаблоны могут быть импортированы из JSON-файла `Templates.json`. Формат:

```json
{
    "id": "UUID-string",
    "templateId": "unique-template-id",
    "title": "Название шаблона",
    "category": "telo|um|dukh|otnosheniya|osvobozhdenie|velikie",
    "duration": 14,
    "quote": "Цитата шаблона",
    "difficulty": 1-3,
    "description": "Описание практики",
    "intention": "Цель практики"
}
```

## Дальнейшие улучшения

- [ ] Интеграция с CloudKit для синхронизации
- [ ] Расширенные социальные функции
- [ ] Командные челленджи
- [ ] Расширенная аналитика
- [ ] Админ-панель для управления шаблонами

## Roadmap

| Спринт | Deliverables |
|--------|--------------|
| 0 (1 нед) | Импорт JSON шаблонов, витрина MVP |
| 1 (2 нед) | Экран шаблона, старт/прогресс, локальная аналитика |
| 2 (2 нед) | Курсы-Пути, статусы, награды |
| 3 (2 нед) | Social Feed, реакции, Team Challenge β |
| 4 (1 нед) | A/B-тест, полировка UI, App Store-скриншоты |